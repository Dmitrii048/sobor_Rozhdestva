---
layout: default
---

<style>
    .single-news-header {
        background-color: #fdfbf7;
        padding: 60px 0;
        text-align: center;
        border-bottom: 1px solid #EAE3D5;
    }
    .news-category-badge {
        display: inline-block;
        background: #f5f2ee;
        color: #C5A059;
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 4px 10px;
        border-radius: 20px;
        margin-bottom: 15px;
    }
    .single-news-container {
        max-width: 800px;
        margin: 60px auto;
        padding: 0 20px;
    }
    .news-meta {
        color: #C5A059;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 14px;
        margin-bottom: 15px;
        display: block;
    }
    .news-image {
        width: 100%;
        height: 400px;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 30px;
    }
    .news-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .news-body {
        font-size: 18px;
        line-height: 1.8;
        color: #333;
        font-family: 'PT Serif', serif;
    }
    .news-body img {
        max-width: 100%;
        height: auto;
        margin: 20px 0;
        border-radius: 4px;
    }
    .news-body p {
        margin-bottom: 25px;
    }
    .back-link {
        display: inline-block;
        margin-top: 40px;
        color: #777;
        text-decoration: none;
        border-bottom: 1px dashed #999;
    }
</style>

<div class="single-news-header">
    <div class="container">
        <span class="news-category-badge">{{ page.category }}</span>
        <span class="news-meta">{{ page.date | date: "%d.%m.%Y" }}</span>
        <h1 class="chapter-title" style="margin-bottom: 0;">{{ page.title }}</h1>
    </div>
</div>

<article class="single-news-container">
    {% if page.image %}
    <div class="news-image">
        <img src="{{ page.image }}" alt="{{ page.title }}">
    </div>
    {% endif %}

    <div class="news-body">
        {{ content }}
    </div>

    <a href="/news/" class="back-link">← Вернуться ко всем новостям</a>
</article>

<script>
    // Автоматически загружаем содержимое новости
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            // Получаем slug из URL
            const path = window.location.pathname;
            const slug = path.split('/').filter(Boolean).pop();
            
            if (!slug) return;
            
            // Загружаем данные новости
            const response = await fetch(`https://api.github.com/repos/Dmitrii048/sobor_Rozhdestva/contents/_posts/${slug}.md`);
            const file = await response.json();
            const content = atob(file.content);
            
            // Парсим Markdown
            const frontMatterMatch = content.match(/---\n([\s\S]*?)\n---/);
            const body = content.split('---')[2] || '';
            
            if (frontMatterMatch) {
                const frontMatter = frontMatterMatch[1];
                const title = frontMatter.match(/title: (.+)/)?.[1] || 'Без заголовка';
                const date = frontMatter.match(/date: (.+)/)?.[1] || '';
                const category = frontMatter.match(/category: (.+)/)?.[1] || 'Главная';
                const image = frontMatter.match(/image: (.+)/)?.[1] || '';
                
                // Обновляем заголовок
                document.querySelector('.chapter-title').textContent = title;
                document.querySelector('.news-meta').textContent = new Date(date).toLocaleDateString('ru-RU');
                document.querySelector('.news-category-badge').textContent = category;
                
                // Обновляем изображение
                if (image && document.querySelector('.news-image img')) {
                    document.querySelector('.news-image img').src = image;
                }
                
                // Обновляем содержимое
                const newsBody = document.querySelector('.news-body');
                if (newsBody) {
                    // Простой парсер Markdown в HTML
                    let html = body
                        .replace(/\n## (.*?)/g, '<h2>$1</h2>')
                        .replace(/\n# (.*?)/g, '<h1>$1</h1>')
                        .replace(/\n\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                        .replace(/\n\*(.*?)\*/g, '<em>$1</em>')
                        .replace(/\n- (.*?)/g, '<li>$1</li>')
                        .replace(/\n\n/g, '<p>');
                    
                    newsBody.innerHTML = `<p>${html}</p>`;
                }
            }
        } catch (error) {
            console.error('Ошибка загрузки новости:', error);
        }
    });
</script>
